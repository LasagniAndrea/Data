<?xml version="1.0" encoding="utf-8" ?>
<Referentials>
	<Referential>
    <!-- 
    CC/PL 20170928 [23429] Analysis amended - Limitation to RoleType like ALGORITHM
    CC/PL 20170918 UPD MPD [23429] New repository 
    -->    
    <TableName>ACTORROLE</TableName>
		<Ressource>ALGORITHM</Ressource>
		<ColumnByRow>3</ColumnByRow>
		<Create>true</Create>
		<Modify>true</Modify>
		<Remove>true</Remove>
		<Image></Image>
		
    <SQLWhere>
      <!--
      USER non admin peut accéder aux acteurs :                             
      - non affectés à un profil (ou model) et créés ou modifiés par lui-même                     
      - accessibles par application des profils rattachés à lui ou à sa hiérarchie (ISENABLED=true) 
      - dits publics ACTEUR.ISENABLED=true                            
      -->
      <ConditionSystem>SESSIONRESTRICT</ConditionSystem>
      <SQLJoin>left outer join dbo.SESSIONRESTRICT sr on sr.ID=tblmain.IDA and sr.CLASS='ACTOR' and sr.SESSIONID='%%SESSIONID%%'</SQLJoin>
      <SQLWhere>
        <![CDATA[
        (
          (sr.ID is not null) 
          or
          (
            (not exists(select 1 from dbo.ACTORMODEL where IDA=tblmain.IDA)) 
            and
            ((tblmain.IDAINS=%%ID_USER%% and tblmain.IDAUPD is null) or tblmain.IDAUPD=%%ID_USER%%)
          )
        )
        ]]>
      </SQLWhere>
    </SQLWhere>
    
		<Column>
			<ColumnName>IDA</ColumnName>
			<Ressource>IDA</Ressource>
			<DataType>int</DataType>
			<Colspan>0</Colspan>
			<Length>10</Length>
			<Scale>0</Scale>
			<IsMandatory>true</IsMandatory>
			<IsHide>false</IsHide>
			<IsHideInDataGrid>false</IsHideInDataGrid>
			<IsForeignKeyField>true</IsForeignKeyField>
			<IsUpdatable>false</IsUpdatable>
			<IsOrderBy>true</IsOrderBy>
			<Relation>
				<TableName>ACTOR</TableName>
				<AliasTableName>a1</AliasTableName>
				<ColumnRelation>
					<ColumnName>IDA</ColumnName>
					<DataType>int</DataType>
				</ColumnRelation>
				<ColumnSelect>
					<ColumnName>IDENTIFIER</ColumnName>
					<Ressource>ALGORITHM</Ressource>
					<DataType>string</DataType>
				</ColumnSelect>
				<ColumnLabel>
					<ColumnName>DISPLAYNAME</ColumnName>
					<Ressource>DISPLAYNAME</Ressource>
					<DataType>string</DataType>
				</ColumnLabel>
        <AutoComplete enabled="true"/>
			</Relation>
			<html_BLOCK title="Role" columnbyrow="3" ></html_BLOCK>
		</Column>
    <Column>
			<ColumnName>IDROLEACTOR</ColumnName>
			<Ressource>IDROLEACTOR</Ressource>
			<DataType>string</DataType>
			<Colspan>0</Colspan>
			<Length>16</Length>
			<Scale>0</Scale>
			<IsMandatory>true</IsMandatory>
			<IsHide>false</IsHide>
			<IsHideInDataGrid>false</IsHideInDataGrid>
			<IsUpdatable>true</IsUpdatable>
      <Relation>
        <TableName>ROLEACTOR</TableName>
				<AliasTableName>ra1</AliasTableName>
				<ColumnRelation>
					<ColumnName>IDROLEACTOR</ColumnName>
					<DataType>string</DataType>
				</ColumnRelation>
				<ColumnSelect>
					<ColumnName>IDROLEACTOR</ColumnName>
					<Ressource>Role</Ressource>
					<DataType>string</DataType>
				</ColumnSelect>
				<ColumnLabel>
					<ColumnName>DESCRIPTION</ColumnName>
					<Ressource>DESCRIPTION</Ressource>
					<DataType>string</DataType>
				</ColumnLabel>
				<Condition>
					<TableName>ROLEACTOR</TableName>
					<AliasTableName>ra2</AliasTableName>
					<ColumnRelation>
						<ColumnName>IDROLEACTOR</ColumnName>
						<DataType>string</DataType>
					</ColumnRelation>
					<SQLWhere>
            (
            (ra2.ROLETYPE like '%ALGORITHM%')
            )
          </SQLWhere>
				</Condition>
			</Relation>
		</Column>
		<Column>
			<ColumnName>IDA_ACTOR</ColumnName>
			<Ressource>ForActor</Ressource>
			<DataType>int</DataType>
			<Colspan>0</Colspan>
			<Length>10</Length>
			<Scale>0</Scale>
			<IsMandatory>false</IsMandatory>
			<IsHide>false</IsHide>
			<IsHideInDataGrid>false</IsHideInDataGrid>
			<IsUpdatable>true</IsUpdatable>
			<Relation>
				<TableName>ACTOR</TableName>
				<AliasTableName>a2</AliasTableName>
				<ColumnRelation>
					<ColumnName>IDA</ColumnName>
					<DataType>int</DataType>
				</ColumnRelation>
				<ColumnSelect>
					<ColumnName>IDENTIFIER</ColumnName>
					<Ressource>ApplyTo</Ressource>
					<DataType>string</DataType>
				</ColumnSelect>
				<ColumnLabel>
					<ColumnName>DISPLAYNAME</ColumnName>
					<Ressource>DISPLAYNAME</Ressource>
					<DataType>string</DataType>
				</ColumnLabel>
        <AutoComplete enabled="true"/>
      </Relation>
			<Information>
				<Type>information</Type>
				<LabelMessage>Msg_AlgorithmRole</LabelMessage>
			</Information>
    </Column>
		<Column>
			<ColumnName>DTENABLED</ColumnName>
			<Ressource>DTENABLED</Ressource>
			<DataType>date</DataType>
			<Length>8</Length>
			<Scale>0</Scale>
			<IsMandatory>true</IsMandatory>
			<Default>
				<Value>today</Value>
			</Default>
			<IsHide>false</IsHide>
			<IsHideInDataGrid>false</IsHideInDataGrid>
			<IsUpdatable>true</IsUpdatable>
			<html_BLOCK title="Status" blockbyrow="2" width="25%" columnbyrow="1"></html_BLOCK>
		</Column>
		<Column>
			<ColumnName>DTDISABLED</ColumnName>
			<Ressource>DTDISABLED</Ressource>
			<DataType>date</DataType>
			<Length>8</Length>
			<Scale>0</Scale>
			<IsMandatory>false</IsMandatory>
			<IsHide>false</IsHide>
			<IsHideInDataGrid>false</IsHideInDataGrid>
			<IsUpdatable>true</IsUpdatable>
		</Column>
		<Column>
			<ColumnName>IDAINS</ColumnName>
			<Ressource>IDAINS</Ressource>
			<DataType>int</DataType>
			<Length>10</Length>
			<Scale>0</Scale>
			<IsMandatory>true</IsMandatory>
			<IsHide>true</IsHide>
			<IsHideInDataGrid>true</IsHideInDataGrid>
			<IsUpdatable>false</IsUpdatable>
			<Relation>
				<TableName>ACTOR</TableName>
				<AliasTableName>insa</AliasTableName>
				<ColumnRelation>
					<ColumnName>IDA</ColumnName>
					<DataType>int</DataType>
				</ColumnRelation>
				<ColumnSelect>
					<ColumnName>DISPLAYNAME</ColumnName>
					<Ressource>Display name</Ressource>
					<DataType>string</DataType>
				</ColumnSelect>
			</Relation>
		</Column>
		<Column>
			<ColumnName>DTINS</ColumnName>
			<Ressource>DTINS</Ressource>
			<DataType>date</DataType>
			<Length>8</Length>
			<Scale>0</Scale>
			<IsMandatory>true</IsMandatory>
			<IsHide>true</IsHide>
			<IsHideInDataGrid>true</IsHideInDataGrid>
			<IsUpdatable>true</IsUpdatable>
		</Column>
		<Column>
			<ColumnName>IDAUPD</ColumnName>
			<Ressource>IDAUPD</Ressource>
			<DataType>int</DataType>
			<Length>10</Length>
			<Scale>0</Scale>
			<IsMandatory>false</IsMandatory>
			<IsHide>true</IsHide>
			<IsHideInDataGrid>true</IsHideInDataGrid>
			<IsUpdatable>false</IsUpdatable>
			<Relation>
				<TableName>ACTOR</TableName>
				<AliasTableName>upda</AliasTableName>
				<ColumnRelation>
					<ColumnName>IDA</ColumnName>
					<DataType>int</DataType>
				</ColumnRelation>
				<ColumnSelect>
					<ColumnName>DISPLAYNAME</ColumnName>
					<Ressource>Display name</Ressource>
					<DataType>string</DataType>
				</ColumnSelect>
			</Relation>
		</Column>
		<Column>
			<ColumnName>DTUPD</ColumnName>
			<Ressource>DTUPD</Ressource>
			<DataType>date</DataType>
			<Length>8</Length>
			<Scale>0</Scale>
			<IsMandatory>false</IsMandatory>
			<IsHide>true</IsHide>
			<IsHideInDataGrid>true</IsHideInDataGrid>
			<IsUpdatable>true</IsUpdatable>
		</Column>
		<Column>
			<ColumnName>EXTLLINK</ColumnName>
			<Ressource>EXTLLINK</Ressource>
			<DataType>string</DataType>
			<Length>64</Length>
			<Scale>0</Scale>
			<IsMandatory>false</IsMandatory>
			<IsHide>false</IsHide>
			<IsHideInDataGrid>false</IsHideInDataGrid>
			<IsUpdatable>true</IsUpdatable>
			<html_BLOCK title="ExtlLink_" blockbyrow="2" width="75%" columnbyrow="1"></html_BLOCK>
		</Column>
		<Column>
			<ColumnName>ROWVERSION</ColumnName>
			<Ressource>ROWVERSION</Ressource>
			<DataType>string</DataType>
			<Length>8</Length>
			<Scale>0</Scale>
			<IsMandatory>true</IsMandatory>
      <IsHide>true</IsHide>
			<IsHideInDataGrid>true</IsHideInDataGrid>
      <IsDataKeyField>true</IsDataKeyField>
			<IsUpdatable>true</IsUpdatable>
		</Column>
	</Referential>
</Referentials>