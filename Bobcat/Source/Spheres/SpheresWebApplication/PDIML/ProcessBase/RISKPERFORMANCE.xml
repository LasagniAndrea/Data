<?xml version="1.0" encoding="utf-8" ?>
<!--FI 20120119 [] mise de IsUseSQLParameters -->
<!--MF 20120720  IsDataKeyField à true pour ENTITY_IDA et CSS_IDA. Solution temporaire en attente du correctif sur le ReferentielData -->
<!--PM 20150520 [20575] Replace DTMARKET with DTENTITY-->
<Referentials>
  <Referential>
    <IsUseSQLParameters>true</IsUseSQLParameters>
    <TableName>xxxxxxxxx</TableName>
    <Ressource></Ressource>
    <ColumnByRow>2</ColumnByRow>
    <Create>false</Create>
    <Modify>false</Modify>
    <Remove>false</Remove>
    <Image></Image>

    <SQLSelect>
      
      <Command rdbms = "all">
        <![CDATA[
        select distinct em.DTENTITY,
        a_entity.IDA as ENTITY_IDA,a_entity.IDENTIFIER as ENTITY_IDENTIFIER,a_entity.DISPLAYNAME as ENTITY_DISPLAYNAME,
        a_css.IDA as CSS_IDA,a_css.IDENTIFIER as CSS_IDENTIFIER,a_css.DISPLAYNAME as CSS_DISPLAYNAME
        from dbo.ENTITYMARKET em
        %%SR:MARKET_JOIN%%(em.IDM)   
        %%SR:ACTOR_JOIN%%(em.IDA)
        inner join dbo.ACTOR a_entity on a_entity.IDA=em.IDA
        inner join dbo.MARKET m on m.IDM = em.IDM
        inner join dbo.ACTOR a_css on a_css.IDA=m.IDA
        where (em.IDA=case when -1=@ENTITY then em.IDA else @ENTITY end)
        ]]>
      </Command>
    </SQLSelect>

    <!--SQLRowStyle type="class">
      <![CDATA[
      case
      when COUNTDTMARKET> 1 then 'DataGrid_ErrorStyle'
      else ''
      end
      ]]>
    </SQLRowStyle-->

    <Column>
      <ColumnName>ENTITY_IDA</ColumnName>
      <Ressource>ENTITY_IDA</Ressource>
      <DataType>int</DataType>
      <Nowrap>true</Nowrap>
      <Length>10</Length>
      <Scale>0</Scale>
      <IsMandatory>false</IsMandatory>
      <RegularExpression></RegularExpression>
      <Default></Default>
      <IsHide>true</IsHide>
      <IsHideInDataGrid>true</IsHideInDataGrid>
      <IsHideInCriteria>true</IsHideInCriteria>
      <IsDataKeyField>false</IsDataKeyField>
      <IsKeyField>false</IsKeyField>
      <IsForeignKeyField>false</IsForeignKeyField>
      <IsIdentity>false</IsIdentity>
      <IsUpdatable>false</IsUpdatable>
      <IsOrderBy>false</IsOrderBy>
    </Column>

    <Column>
      <ColumnName>ENTITY_IDENTIFIER</ColumnName>
      <Ressource>IDA_ENTITY_2</Ressource>
      <DataType>string</DataType>
      <Scale>0</Scale>
      <IsMandatory>false</IsMandatory>
      <RegularExpression></RegularExpression>
      <Default></Default>
      <IsHide>false</IsHide>
      <IsHideInDataGrid>false</IsHideInDataGrid>
      <IsKeyField>false</IsKeyField>
      <IsDataKeyField>false</IsDataKeyField>
      <IsResource>false</IsResource>
      <IsOrderBy>true</IsOrderBy>
      <IsHyperLink linktype="column" type="IDA" data="ENTITY_IDA" condition="ENTITY" linktable="ACTOR" name="IDENTIFIER">true</IsHyperLink>
    </Column>
    <Column>
      <ColumnName>ENTITY_DISPLAYNAME</ColumnName>
      <Ressource></Ressource>
      <DataType>string</DataType>
      <Scale>0</Scale>
      <IsMandatory>false</IsMandatory>
      <RegularExpression></RegularExpression>
      <Default></Default>
      <IsHide>false</IsHide>
      <IsHideInDataGrid>false</IsHideInDataGrid>
      <IsKeyField>false</IsKeyField>
      <IsDataKeyField>false</IsDataKeyField>
      <IsIdentity>false</IsIdentity>
      <IsResource>false</IsResource>
      <IsOrderBy>false</IsOrderBy>
      <IsHyperLink linktype="column" type="IDA" data="ENTITY_IDA" condition="ENTITY" linktable="ACTOR" name="DISPLAYNAME">false</IsHyperLink>
    </Column>

    <Column>
      <ColumnName>CSS_IDA</ColumnName>
      <Ressource></Ressource>
      <DataType>int</DataType>
      <Nowrap>true</Nowrap>
      <Length>10</Length>
      <Scale>0</Scale>
      <IsMandatory>false</IsMandatory>
      <RegularExpression></RegularExpression>
      <Default></Default>
      <IsHide>true</IsHide>
      <IsHideInDataGrid>true</IsHideInDataGrid>
      <IsHideInCriteria>true</IsHideInCriteria>
      <IsDataKeyField>false</IsDataKeyField>
      <IsKeyField>false</IsKeyField>
      <IsForeignKeyField>false</IsForeignKeyField>
      <IsIdentity>false</IsIdentity>
      <IsUpdatable>false</IsUpdatable>
      <IsOrderBy>false</IsOrderBy>
    </Column>
    <Column>
      <ColumnName>CSS_IDENTIFIER</ColumnName>
      <Ressource>ClearingHouse2</Ressource>
      <DataType>string</DataType>
      <Scale>0</Scale>
      <IsMandatory>false</IsMandatory>
      <RegularExpression></RegularExpression>
      <Default></Default>
      <IsHide>false</IsHide>
      <IsHideInDataGrid>false</IsHideInDataGrid>
      <IsKeyField>false</IsKeyField>
      <IsDataKeyField>false</IsDataKeyField>
      <IsIdentity>false</IsIdentity>
      <IsOrderBy>true</IsOrderBy>
      <IsHyperLink linktype="column" type="IDA" data="CSS_IDA" condition="CSS" linktable="ACTOR" name="IDENTIFIER">true</IsHyperLink>
    </Column>
    <Column>
      <ColumnName>CSS_DISPLAYNAME</ColumnName>
      <Ressource></Ressource>
      <DataType>string</DataType>
      <Scale>0</Scale>
      <IsMandatory>false</IsMandatory>
      <RegularExpression></RegularExpression>
      <Default></Default>
      <IsHide>false</IsHide>
      <IsHideInDataGrid>false</IsHideInDataGrid>
      <IsKeyField>false</IsKeyField>
      <IsDataKeyField>false</IsDataKeyField>
      <IsIdentity>false</IsIdentity>
      <IsOrderBy>false</IsOrderBy>
      <IsHyperLink linktype="column" type="IDA" data="CSS_IDA" condition="CSS" linktable="ACTOR" name="DISPLAYNAME">false</IsHyperLink>
    </Column>

    <!-- DTENTITY -->
    <Column>
      <ColumnName>DTENTITY</ColumnName>
      <Ressource>DTMARKET1</Ressource>
      <DataType>date</DataType>
      <Length>8</Length>
      <Scale>0</Scale>
      <IsMandatory>false</IsMandatory>
      <RegularExpression></RegularExpression>
      <Default></Default>
      <IsHide>false</IsHide>
      <IsHideInDataGrid>false</IsHideInDataGrid>
      <IsKeyField>false</IsKeyField>
      <IsDataKeyField>false</IsDataKeyField>
      <IsIdentity>false</IsIdentity>
      <IsOrderBy>true</IsOrderBy>
    </Column>

    <!--
    <Column>
      <ColumnName>COUNTDTMARKET</ColumnName>
      <Ressource>COUNTDTMARKET</Ressource>
      <DataType>int</DataType>
      <Length>10</Length>
      <Scale>0</Scale>
      <IsMandatory>false</IsMandatory>
      <RegularExpression></RegularExpression>
      <Default></Default>
      <IsHide>true</IsHide>
      <IsHideInDataGrid>false</IsHideInDataGrid>
      <IsHideInCriteria>true</IsHideInCriteria>
      <IsDataKeyField>false</IsDataKeyField>
      <IsKeyField>false</IsKeyField>
      <IsForeignKeyField>false</IsForeignKeyField>
      <IsIdentity>false</IsIdentity>
      <IsUpdatable>false</IsUpdatable>
      <IsOrderBy>false</IsOrderBy>
    </Column>
    <Column>
      <ColumnName>COUNTDTMARKETINFO</ColumnName>
      <Ressource>COUNTDTMARKETINFO</Ressource>
      <DataType>string</DataType>
      <Scale>0</Scale>
      <IsMandatory>false</IsMandatory>
      <RegularExpression></RegularExpression>
      <Default></Default>
      <IsHide>false</IsHide>
      <IsHideInDataGrid>false</IsHideInDataGrid>
      <IsHideInCriteria>true</IsHideInCriteria>
      <IsKeyField>false</IsKeyField>
      <IsDataKeyField>false</IsDataKeyField>
      <IsIdentity>false</IsIdentity>
      <IsOrderBy>false</IsOrderBy>
      <IsResource>true</IsResource>
    </Column>
    -->
  </Referential>
</Referentials>
